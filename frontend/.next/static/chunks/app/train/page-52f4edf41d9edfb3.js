(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[127],{844:(e,t,a)=>{Promise.resolve().then(a.bind(a,6211)),Promise.resolve().then(a.bind(a,9685))},3655:(e,t,a)=>{"use strict";a.d(t,{hO:()=>o,sG:()=>i});var r=a(2115),s=a(7650),n=a(9708),l=a(5155),i=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let a=(0,n.TL)(`Primitive.${t}`),s=r.forwardRef((e,r)=>{let{asChild:s,...n}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,l.jsx)(s?a:t,{...n,ref:r})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{});function o(e,t){e&&s.flushSync(()=>e.dispatchEvent(t))}},6081:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var r=a(2115),s=a(5155);function n(e,t=[]){let a=[],l=()=>{let t=a.map(e=>r.createContext(e));return function(a){let s=a?.[e]||t;return r.useMemo(()=>({[`__scope${e}`]:{...a,[e]:s}}),[a,s])}};return l.scopeName=e,[function(t,n){let l=r.createContext(n),i=a.length;a=[...a,n];let o=t=>{let{scope:a,children:n,...o}=t,d=a?.[e]?.[i]||l,c=r.useMemo(()=>o,Object.values(o));return(0,s.jsx)(d.Provider,{value:c,children:n})};return o.displayName=t+"Provider",[o,function(a,s){let o=s?.[e]?.[i]||l,d=r.useContext(o);if(d)return d;if(void 0!==n)return n;throw Error(`\`${a}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let a=()=>{let a=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=a.reduce((t,{useScope:a,scopeName:r})=>{let s=a(e)[`__scope${r}`];return{...t,...s}},{});return r.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return a.scopeName=t.scopeName,a}(l,...t)]}},6211:(e,t,a)=>{"use strict";a.d(t,{ChatTrainer:()=>C});var r=a(5155),s=a(2115),n=a(7168),l=a(8482),i=a(9474),o=a(6081),d=a(3655),c="Progress",[u,m]=(0,o.A)(c),[x,p]=u(c),f=s.forwardRef((e,t)=>{var a,s,n,l;let{__scopeProgress:i,value:o=null,max:c,getValueLabel:u=b,...m}=e;(c||0===c)&&!N(c)&&console.error((a="".concat(c),s="Progress","Invalid prop `max` of value `".concat(a,"` supplied to `").concat(s,"`. Only numbers greater than 0 are valid max values. Defaulting to `").concat(100,"`.")));let p=N(c)?c:100;null===o||y(o,p)||console.error((n="".concat(o),l="Progress","Invalid prop `value` of value `".concat(n,"` supplied to `").concat(l,"`. The `value` prop must be:\n  - a positive number\n  - less than the value passed to `max` (or ").concat(100," if no `max` prop is set)\n  - `null` or `undefined` if the progress is indeterminate.\n\nDefaulting to `null`.")));let f=y(o,p)?o:null,v=j(f)?u(f,p):void 0;return(0,r.jsx)(x,{scope:i,value:f,max:p,children:(0,r.jsx)(d.sG.div,{"aria-valuemax":p,"aria-valuemin":0,"aria-valuenow":j(f)?f:void 0,"aria-valuetext":v,role:"progressbar","data-state":g(f,p),"data-value":null!=f?f:void 0,"data-max":p,...m,ref:t})})});f.displayName=c;var v="ProgressIndicator",h=s.forwardRef((e,t)=>{var a;let{__scopeProgress:s,...n}=e,l=p(v,s);return(0,r.jsx)(d.sG.div,{"data-state":g(l.value,l.max),"data-value":null!==(a=l.value)&&void 0!==a?a:void 0,"data-max":l.max,...n,ref:t})});function b(e,t){return"".concat(Math.round(e/t*100),"%")}function g(e,t){return null==e?"indeterminate":e===t?"complete":"loading"}function j(e){return"number"==typeof e}function N(e){return j(e)&&!isNaN(e)&&e>0}function y(e,t){return j(e)&&!isNaN(e)&&e<=t&&e>=0}h.displayName=v;var w=a(3999);function S(e){let{className:t,value:a,...s}=e;return(0,r.jsx)(f,{"data-slot":"progress",className:(0,w.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",t),...s,children:(0,r.jsx)(h,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:"translateX(-".concat(100-(a||0),"%)")}})})}var k=a(1886);let _={gender:"gpt4-gender","sexual-orientation":"llama3-sexual",age:"gemini-age"};function C(){let[e,t]=(0,s.useState)(null),[a,o]=(0,s.useState)([]),[d,c]=(0,s.useState)(""),[u,m]=(0,s.useState)(!1),[x,p]=(0,s.useState)(null),[f,v]=(0,s.useState)(""),[h,b]=(0,s.useState)(null),[g,j]=(0,s.useState)(null),[N,y]=(0,s.useState)([]),C=(0,s.useRef)(null);async function I(e){if(!u){t(e),o([]),v(""),b(null),j(null),p(null);try{encodeURIComponent(e);let{sentence:t}=await (0,k.GC)(e);v(t),t&&o([{id:crypto.randomUUID(),role:"ai",content:"Here's a sentence that might have some bias:\n\n\"".concat(t,'"\n\n')+"Pick a minimal change and tell me how to rewrite it to be fairer."}])}catch(e){p((null==e?void 0:e.message)||"Failed to fetch a sample sentence.")}}}(0,s.useEffect)(()=>{var e;null===(e=C.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[a]);let T=(0,s.useMemo)(()=>!!e&&!!f&&d.trim().length>0&&!u,[e,f,d,u]);async function $(t){if(t.preventDefault(),!T||!e)return;m(!0),p(null);let a={id:crypto.randomUUID(),role:"user",content:d};o(e=>[...e,a]),c("");try{var r;let t=await (0,k.Zf)({mode:_[e],original:f,instruction:d,messages:[]}),a=null!==(r=null==t?void 0:t.reply)&&void 0!==r?r:"Thanks! I evaluated your instruction and applied a fairer rewrite.",s="number"==typeof(null==t?void 0:t.score)?100*t.score:0,n=!!(null==t?void 0:t.passed),l="number"==typeof(null==t?void 0:t.points_awarded)?t.points_awarded:0,i={id:crypto.randomUUID(),role:"ai",content:a,biasScore:null!=s?s:void 0};if(o(e=>[...e,i]),"number"==typeof s&&b(s),"number"==typeof s){let t={sentence:f,newScore:s,at:new Date().toISOString()};y(e=>[t,...e.slice(0,19)]),window.dispatchEvent(new CustomEvent("bias-history-add",{detail:{original:f,bias_type:P(e),original_score:void 0,rewrite_score:s,created_at:t.at}}))}n&&j({points:l})}catch(e){p((null==e?void 0:e.message)||"Request failed.")}finally{m(!1)}}return(0,r.jsxs)("div",{className:"flex relative overflow-hidden",children:[(0,r.jsxs)("div",{className:"flex-1 flex flex-col min-h-[calc(100vh-80px)]",children:[(0,r.jsx)("div",{className:"px-6 py-4 border-b border-border bg-card/50 backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto flex items-center gap-3",children:[(0,r.jsx)("span",{className:"text-sm font-semibold text-foreground",children:"Bias Type:"}),(0,r.jsx)("div",{className:"flex gap-2 bg-muted/50 p-1.5 rounded-full",children:[{value:"gender",label:"Gender"},{value:"sexual-orientation",label:"Sexual Orientation"},{value:"age",label:"Age"}].map(t=>(0,r.jsx)("button",{onClick:()=>I(t.value),className:(0,w.cn)("px-5 py-2.5 rounded-full text-sm font-bold transition-all",e===t.value?"bg-primary text-primary-foreground shadow":"bg-transparent text-muted-foreground hover:text-foreground hover:bg-muted/80"),children:t.label},t.value))})]})}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto px-6 py-6",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto space-y-4",id:"chat-area",children:[!e&&0===a.length&&(0,r.jsx)(l.Zp,{className:"p-6 text-sm text-muted-foreground",children:"Choose a bias type above to start a session."}),a.map(e=>(0,r.jsx)("div",{className:(0,w.cn)("flex","user"===e.role?"justify-end":"justify-start"),children:(0,r.jsxs)("div",{className:(0,w.cn)("max-w-[80%] rounded-2xl px-5 py-4 shadow","user"===e.role?"rounded-br-sm bg-primary text-primary-foreground":"rounded-bl-sm bg-card border text-card-foreground"),children:[(0,r.jsx)("p",{className:"text-sm whitespace-pre-line",children:e.content}),"number"==typeof e.biasScore&&(0,r.jsxs)("div",{className:"mt-3 p-3 bg-emerald-50 rounded-lg border border-emerald-200",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("span",{className:"text-xs font-bold text-emerald-700",children:"New Bias Score"}),(0,r.jsxs)("span",{className:"text-sm font-bold text-emerald-700",children:[e.biasScore,"%"]})]}),(0,r.jsx)("div",{className:"relative h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 bg-emerald-500 rounded-full",style:{width:"".concat(e.biasScore,"%")}})})]})]})},e.id)),(0,r.jsx)("div",{ref:C})]})}),(0,r.jsxs)("div",{className:"border-t border-border bg-surface/80 backdrop-blur-sm px-6 py-4",children:[(0,r.jsx)("form",{onSubmit:$,className:"max-w-4xl mx-auto",children:(0,r.jsxs)("div",{className:"flex gap-3 items-end",children:[(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsx)(i.T,{value:d,onChange:e=>c(e.target.value),placeholder:"Tell the AI how to minimally rewrite the sentence to remove bias…",rows:3,disabled:!e||u||!f})}),(0,r.jsx)(n.$,{type:"submit",size:"lg",disabled:!T,children:u?"Working…":"Send & Rescore"})]})}),x&&(0,r.jsx)("div",{className:"max-w-4xl mx-auto mt-2 text-sm text-red-600",children:x})]})]}),(0,r.jsxs)("div",{className:"w-80 border-l border-border bg-background overflow-y-auto p-4 space-y-4",children:[(0,r.jsxs)(l.Zp,{className:"p-5",children:[(0,r.jsx)("h3",{className:"text-sm font-bold mb-3",children:"Current Challenge"}),e?(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-muted-foreground mb-1 font-semibold",children:"Sentence"}),(0,r.jsx)("p",{className:"text-sm text-foreground leading-relaxed",children:f||"—"})]}),"number"==typeof h&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("span",{className:"text-xs font-bold text-gray-700",children:"Bias Score"}),(0,r.jsxs)("span",{className:"text-sm font-bold",children:[h,"%"]})]}),(0,r.jsx)(S,{value:h,className:"h-2"})]}),e&&(0,r.jsxs)("div",{className:"inline-block px-3 py-1.5 rounded-full bg-muted text-xs font-bold",children:[P(e)," Bias"]})]}):(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Pick a bias type to begin."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-bold mb-3 px-1",children:"Past Performance"}),(0,r.jsx)("div",{className:"space-y-2",children:0===N.length?(0,r.jsx)(l.Zp,{className:"p-4 border-dashed",children:(0,r.jsx)("p",{className:"text-xs text-muted-foreground text-center",children:"No history yet. Start training!"})}):N.map((e,t)=>(0,r.jsxs)(l.Zp,{className:"p-3",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between gap-2 mb-2",children:[(0,r.jsx)("p",{className:"text-xs text-foreground line-clamp-2 flex-1",children:e.sentence}),(0,r.jsxs)("div",{className:"text-xs font-bold shrink-0 px-2 py-1 rounded-full bg-muted",children:[e.newScore,"%"]})]}),(0,r.jsx)("p",{className:"text-[10px] text-muted-foreground",children:new Date(e.at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},t))})]})]}),g&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,r.jsxs)(l.Zp,{className:"p-6 w-[420px] space-y-3",children:[(0,r.jsx)("div",{className:"text-lg font-semibold",children:"Great job!"}),(0,r.jsxs)("div",{className:"text-sm",children:["Challenge completed. You earned ",(0,r.jsx)("b",{children:g.points})," points."]}),(0,r.jsx)("div",{className:"flex gap-3 justify-end pt-2",children:(0,r.jsx)(n.$,{onClick:function(){t(null),o([]),v(""),b(null),j(null),p(null),c("")},children:"Start Again"})})]})})]})}function P(e){return"sexual-orientation"===e?"Sexual Orientation":"gender"===e?"Gender":"Age"}},9474:(e,t,a)=>{"use strict";a.d(t,{T:()=>n});var r=a(5155);a(2115);var s=a(3999);function n(e){let{className:t,...a}=e;return(0,r.jsx)("textarea",{"data-slot":"textarea",className:(0,s.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...a})}}},e=>{var t=t=>e(e.s=t);e.O(0,[965,277,834,631,310,732,441,684,358],()=>t(844)),_N_E=e.O()}]);