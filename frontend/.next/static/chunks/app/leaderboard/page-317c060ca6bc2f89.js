(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[410],{2993:(e,s,t)=>{Promise.resolve().then(t.bind(t,7484)),Promise.resolve().then(t.bind(t,9685))},7484:(e,s,t)=>{"use strict";t.d(s,{default:()=>r});var l=t(5155),i=t(2115),a=t(8482),n=t(7168),d=t(1886);function r(){var e;let[s,t]=(0,i.useState)("alltime"),[n,r]=(0,i.useState)([]),[p,h]=(0,i.useState)(null),[v,f]=(0,i.useState)(!0),[j,N]=(0,i.useState)(null);(0,i.useEffect)(()=>{let e=!1;return async function(){f(!0),N(null);try{let[t,l]=await Promise.all([(0,d.Vg)("/api/me/summary"),(0,d.Vg)("/api/leaderboard?timeframe=".concat(s))]);if(e)return;h(null!=t?t:null);let i=Array.isArray(null==l?void 0:l.items)?l.items:[];i.sort((e,s)=>{var t,l;return(null!==(t=s.points)&&void 0!==t?t:0)-(null!==(l=e.points)&&void 0!==l?l:0)});let a=i.map((e,s)=>{var t;return{...e,rank:null!==(t=e.rank)&&void 0!==t?t:s+1}});r(a)}catch(s){if(e)return;N((null==s?void 0:s.message)||"Failed to load leaderboard."),r([])}finally{e||f(!1)}}(),()=>{e=!0}},[s]);let g=(0,i.useMemo)(()=>n.slice(0,3),[n]);return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,l.jsx)("h1",{className:"text-xl font-semibold",children:"Leaderboard"}),(0,l.jsxs)("div",{className:"flex items-center gap-2 bg-muted/50 p-1 rounded-xl",children:[(0,l.jsx)(c,{label:"Daily",active:"daily"===s,onClick:()=>t("daily")}),(0,l.jsx)(c,{label:"Weekly",active:"weekly"===s,onClick:()=>t("weekly")}),(0,l.jsx)(c,{label:"All-time",active:"alltime"===s,onClick:()=>t("alltime")})]})]}),(0,l.jsx)(a.Zp,{className:"p-4",children:(0,l.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)(m,{name:null==p?void 0:p.username,photoURL:null==p?void 0:p.photoURL,size:40}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-sm text-muted-foreground",children:"You"}),(0,l.jsx)("div",{className:"text-base font-semibold",children:null!==(e=null==p?void 0:p.username)&&void 0!==e?e:"Anonymous"})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-8",children:[(0,l.jsx)(o,{label:"Rank",value:(null==p?void 0:p.rank)!=null?"#".concat(p.rank):"—"}),(0,l.jsx)(o,{label:"Total Points",value:(null==p?void 0:p.points)!=null?p.points.toString():"—"})]})]})}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[g.map(e=>{var s,t;return(0,l.jsxs)(a.Zp,{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("span",{className:"text-xs font-medium text-muted-foreground",children:["#",e.rank]}),(0,l.jsx)("span",{className:"text-xs font-medium bg-muted px-2 py-0.5 rounded-full",children:u(e.points)})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3 mt-3",children:[(0,l.jsx)(m,{name:null!==(s=e.displayName)&&void 0!==s?s:e.id,photoURL:e.photoURL,size:44}),(0,l.jsxs)("div",{className:"truncate",children:[(0,l.jsx)("div",{className:"text-sm font-semibold truncate",children:null!==(t=e.displayName)&&void 0!==t?t:x(e.id)}),(0,l.jsx)("div",{className:"text-xs text-muted-foreground truncate",children:x(e.id)})]})]})]},e.id)}),0===g.length&&(0,l.jsx)(a.Zp,{className:"p-4",children:(0,l.jsx)("div",{className:"text-sm text-muted-foreground",children:"No entries yet."})})]}),(0,l.jsx)(a.Zp,{className:"p-0 overflow-hidden",children:(0,l.jsxs)("div",{className:"min-w-full",children:[(0,l.jsxs)("div",{className:"grid grid-cols-[64px_1fr_120px] px-4 py-2 bg-muted/40 text-xs font-medium text-muted-foreground",children:[(0,l.jsx)("div",{children:"Rank"}),(0,l.jsx)("div",{children:"Player"}),(0,l.jsx)("div",{className:"text-right",children:"Points"})]}),v?(0,l.jsx)("div",{className:"px-4 py-6 text-sm text-muted-foreground",children:"Loading…"}):j?(0,l.jsx)("div",{className:"px-4 py-6 text-sm text-red-600",children:j}):0===n.length?(0,l.jsx)("div",{className:"px-4 py-6 text-sm text-muted-foreground",children:"No data."}):(0,l.jsx)("ul",{className:"divide-y",children:n.map(e=>{var s,t;let i=p&&(p.uid===e.id||p.username===e.displayName);return(0,l.jsxs)("li",{className:"px-4 py-3 grid grid-cols-[64px_1fr_120px] items-center ".concat(i?"bg-primary/5":""),children:[(0,l.jsxs)("div",{className:"text-sm font-semibold",children:["#",e.rank]}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)(m,{name:null!==(s=e.displayName)&&void 0!==s?s:e.id,photoURL:e.photoURL,size:28}),(0,l.jsxs)("div",{className:"truncate",children:[(0,l.jsxs)("div",{className:"text-sm font-medium truncate",children:[null!==(t=e.displayName)&&void 0!==t?t:x(e.id),i&&(0,l.jsx)("span",{className:"ml-2 text-[10px] font-semibold text-primary px-1.5 py-0.5 bg-primary/10 rounded",children:"You"})]}),(0,l.jsx)("div",{className:"text-xs text-muted-foreground truncate",children:x(e.id)})]})]}),(0,l.jsx)("div",{className:"text-right text-sm font-semibold",children:u(e.points)})]},"".concat(e.id,"-").concat(e.rank))})})]})})]})}function c(e){let{label:s,active:t,onClick:i}=e;return(0,l.jsx)(n.$,{size:"sm",variant:t?"default":"ghost",onClick:i,className:t?"shadow":"text-muted-foreground",children:s})}function o(e){let{label:s,value:t}=e;return(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsx)("div",{className:"text-xs text-muted-foreground",children:s}),(0,l.jsx)("div",{className:"text-base font-semibold",children:t})]})}function m(e){let{name:s,photoURL:t,size:i=32}=e,a=(null!=s?s:"?").split(" ").map(e=>e[0]).join("").slice(0,2).toUpperCase();return t?(0,l.jsx)("img",{src:t,alt:null!=s?s:"avatar",width:i,height:i,className:"rounded-full object-cover"}):(0,l.jsx)("div",{style:{width:i,height:i},className:"rounded-full bg-muted flex items-center justify-center text-[12px] font-bold",title:s,children:a||"?"})}function x(e){return e?e.length<=10?e:"".concat(e.slice(0,6),"…").concat(e.slice(-4)):""}function u(e){return"number"!=typeof e?"0":e.toLocaleString()}}},e=>{var s=s=>e(e.s=s);e.O(0,[965,277,834,631,310,732,441,684,358],()=>s(2993)),_N_E=e.O()}]);